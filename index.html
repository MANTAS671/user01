<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blackjack —Å –∫—É—Ä–∏—Ü–µ–π</title>
<style>
  body {
    margin: 0;
    font-family: 'Arial', sans-serif;
    background: #0f0f0f;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    overflow-x: hidden;
  }
  h1 {
    margin-top: 10px;
    font-size: 2rem;
    text-shadow: 0 0 10px #ffd700;
  }
  #balance {
    margin: 5px 0;
    font-size: 1.2rem;
  }
  .arena {
    position: relative;
    width: 100%;
    max-width: 600px;
    margin: 20px auto;
    padding: 15px;
    background: #1c1c1c;
    border-radius: 15px;
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
  }
  .spectators {
    position: absolute;
    top: -30px;
    left: 0;
    width: 100%;
    height: 30px;
    background: linear-gradient(to bottom, #444, transparent);
    display: flex;
    justify-content: space-around;
    animation: spectatorsMove 2s infinite alternate ease-in-out;
  }
  .spectator {
    width: 10px;
    height: 20px;
    background: #555;
    border-radius: 50% 50% 0 0;
  }
  @keyframes spectatorsMove {
    0% { transform: translateY(0); }
    100% { transform: translateY(-5px); }
  }
  .dealer, .player {
    text-align: center;
    margin: 10px 0;
  }
  .dealer img {
    width: 100px;
    transition: transform 0.5s;
  }
  .dealer.win img { transform: rotate(-10deg) scale(1.2); }
  .dealer.lose img { transform: translateY(10px) scale(0.9); opacity: 0.7; }
  .cards {
    display: flex;
    justify-content: center;
    gap: 5px;
    margin-top: 10px;
    flex-wrap: wrap;
  }
  .card {
    width: 50px;
    height: 70px;
    background: #fff;
    color: #000;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 1.2rem;
    box-shadow: 0 3px 8px rgba(0,0,0,0.5);
    opacity: 0;
    transform: translateY(-50px) rotate(-10deg);
    animation: dealCard 0.5s forwards;
  }
  @keyframes dealCard {
    to { opacity: 1; transform: translateY(0) rotate(0); }
  }
  #controls {
    margin-top: 10px;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
  }
  button {
    background: #ffd700;
    color: #000;
    font-weight: bold;
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    transition: background 0.3s;
  }
  button:hover { background: #ffea70; }
  input[type=number] {
    width: 100px;
    padding: 5px;
    font-size: 1rem;
    margin-top: 10px;
    text-align: center;
  }
  #message {
    margin-top: 15px;
    font-size: 1.3rem;
    text-shadow: 0 0 5px #ffd700;
  }
  /* –ò—Å—Ç–æ—Ä–∏—è */
  .history {
    width: 100%;
    max-width: 600px;
    margin-top: 20px;
    background: #222;
    border-radius: 10px;
    padding: 10px;
    box-shadow: 0 0 10px rgba(255,215,0,0.2);
  }
  .history table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.9rem;
  }
  .history th, .history td {
    border-bottom: 1px solid #444;
    padding: 5px;
    text-align: center;
  }
  .win-row { color: #00ff90; }
  .lose-row { color: #ff4b4b; }
  .draw-row { color: #ffd700; }
  /* –ê–¥–∞–ø—Ç–∏–≤ */
  @media(max-width:600px){
    .card { width: 40px; height: 60px; font-size: 1rem; }
    .dealer img { width: 80px; }
  }
</style>
</head>
<body>
  <h1>Blackjack —Å –∫—É—Ä–∏—Ü–µ–π</h1>
  <div id="balance"></div>
  <div>
    <label>–°—Ç–∞–≤–∫–∞: </label>
    <input type="number" id="bet" min="100" step="100">
    <button onclick="startGame()">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
    <button onclick="toggleMusic()">üéµ</button>
  </div>

  <div class="arena">
    <div class="spectators">
      <div class="spectator"></div><div class="spectator"></div><div class="spectator"></div>
      <div class="spectator"></div><div class="spectator"></div><div class="spectator"></div>
    </div>

    <div id="dealer" class="dealer">
      <img src="https://cdn-icons-png.flaticon.com/512/1998/1998611.png" alt="–ö—É—Ä–∏—Ü–∞-–∫—Ä—É–ø—å–µ">
      <div>–ö–∞—Ä—Ç—ã –∫—Ä—É–ø—å–µ:</div>
      <div class="cards" id="dealer-cards"></div>
      <div>–û—á–∫–∏: <span id="dealer-score">0</span></div>
    </div>

    <div id="player" class="player">
      <div>–¢–≤–æ–∏ –∫–∞—Ä—Ç—ã:</div>
      <div class="cards" id="player-cards"></div>
      <div>–û—á–∫–∏: <span id="player-score">0</span></div>
    </div>

    <div id="controls" style="display:none;">
      <button onclick="hit()">–í–∑—è—Ç—å –∫–∞—Ä—Ç—É</button>
      <button onclick="stand()">–•–≤–∞—Ç–∏—Ç</button>
    </div>

    <div id="message"></div>
  </div>

  <div class="history">
    <table>
      <thead>
        <tr><th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th><th>–°—Ç–∞–≤–∫–∞</th><th>–ë–∞–ª–∞–Ω—Å</th></tr>
      </thead>
      <tbody id="history-body"></tbody>
    </table>
  </div>

  <audio id="bg-music" loop>
    <source src="https://cdn.pixabay.com/download/audio/2023/07/31/audio_4f5f76e197.mp3?filename=casino-loop-14794.mp3" type="audio/mpeg">
  </audio>
  <audio id="sound-deal" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_9b2a0fd1b0.mp3?filename=chicken-cluck-2-6867.mp3"></audio>
  <audio id="sound-win" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_7b75ec2d5e.mp3?filename=chicken-cluck-6866.mp3"></audio>
  <audio id="sound-lose" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_3cbd932a7f.mp3?filename=chicken-cry-6869.mp3"></audio>

<script>
let balance = parseInt(localStorage.getItem('balance')) || 50000;
let historyData = JSON.parse(localStorage.getItem('history')) || [];
let bet = 1000;
let deck = [];
let playerCards = [];
let dealerCards = [];
let gameOver = false;

document.getElementById('bet').value = bet;
updateBalance();
renderHistory();

function createDeck() {
  const suits = ['‚ô†', '‚ô•', '‚ô¶', '‚ô£'];
  const values = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
  deck = [];
  for (let s of suits) {
    for (let v of values) {
      deck.push({value:v,suit:s});
    }
  }
}

function drawCard() {
  const idx = Math.floor(Math.random()*deck.length);
  return deck.splice(idx,1)[0];
}

function calculateScore(cards) {
  let score=0, aces=0;
  for (let c of cards){
    if(['J','Q','K'].includes(c.value)) score+=10;
    else if(c.value==='A'){ score+=11; aces++; }
    else score+=parseInt(c.value);
  }
  while(score>21 && aces>0){ score-=10; aces--; }
  return score;
}

function renderCards() {
  document.getElementById('player-cards').innerHTML = playerCards.map(c=>`<div class="card">${c.value}${c.suit}</div>`).join('');
  document.getElementById('dealer-cards').innerHTML = dealerCards.map(c=>`<div class="card">${c.value}${c.suit}</div>`).join('');
  document.getElementById('player-score').textContent = calculateScore(playerCards);
  document.getElementById('dealer-score').textContent = calculateScore(dealerCards);
}

function startGame(){
  bet = parseInt(document.getElementById('bet').value);
  if(bet>balance || bet<=0){ alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –∏–ª–∏ —Å—Ç–∞–≤–∫–∞ –Ω–µ–≤–µ—Ä–Ω–∞'); return; }
  createDeck();
  playerCards=[drawCard(), drawCard()];
  dealerCards=[drawCard(), drawCard()];
  gameOver=false;
  document.getElementById('message').textContent='';
  document.getElementById('controls').style.display='flex';
  document.getElementById('dealer').className='dealer';
  playSound('deal');
  renderCards();
}

function hit(){
  if(gameOver) return;
  playerCards.push(drawCard());
  playSound('deal');
  renderCards();
  if(calculateScore(playerCards)>21){
    balance-=bet;
    endGame('–ü–µ—Ä–µ–±–æ—Ä! –¢—ã –ø—Ä–æ–∏–≥—Ä–∞–ª.', 'lose');
  }
}

function stand(){
  if(gameOver) return;
  while(calculateScore(dealerCards)<17){
    dealerCards.push(drawCard());
  }
  const ps=calculateScore(playerCards);
  const ds=calculateScore(dealerCards);
  if(ds>21 || ps>ds){
    balance+=bet;
    endGame('–¢—ã –≤—ã–∏–≥—Ä–∞–ª!', 'win');
  } else if(ps<ds){
    balance-=bet;
    endGame('–ö—É—Ä–∏—Ü–∞ –ø–æ–±–µ–¥–∏–ª–∞!', 'lose');
  } else {
    endGame('–ù–∏—á—å—è!', 'draw');
  }
}

function endGame(message, result){
  document.getElementById('message').textContent = message;
  document.getElementById('controls').style.display='none';
  document.getElementById('dealer').classList.add(result==='win'?'lose':result==='lose'?'win':'');
  playSound(result);
  updateBalance();
  addHistory(result, bet, balance);
  gameOver=true;
}

function updateBalance(){
  document.getElementById('balance').textContent = `–ë–∞–ª–∞–Ω—Å: ${balance.toLocaleString()} MDL`;
  localStorage.setItem('balance', balance);
}

function playSound(type){
  const sounds = {
    deal:'sound-deal',
    win:'sound-win',
    lose:'sound-lose'
  };
  const el=document.getElementById(sounds[type]);
  if(el){ el.currentTime=0; el.play(); }
}

function addHistory(result, bet, bal){
  historyData.unshift({result, bet, balance: bal});
  if(historyData.length>10) historyData.pop();
  localStorage.setItem('history', JSON.stringify(historyData));
  renderHistory();
}

function renderHistory(){
  const tbody=document.getElementById('history-body');
  tbody.innerHTML='';
  historyData.forEach(h=>{
    const tr=document.createElement('tr');
    tr.className = h.result==='win'?'win-row':h.result==='lose'?'lose-row':'draw-row';
    tr.innerHTML=`<td>${h.result==='win'?'–ü–æ–±–µ–¥–∞':h.result==='lose'?'–ü—Ä–æ–∏–≥—Ä—ã—à':'–ù–∏—á—å—è'}</td>
                  <td>${h.bet.toLocaleString()} MDL</td>
                  <td>${h.balance.toLocaleString()} MDL</td>`;
    tbody.appendChild(tr);
  });
}

function toggleMusic(){
  const music=document.getElementById('bg-music');
  if(music.paused){ music.play(); } else { music.pause(); }
}
</script>
</body>
</html>
