<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blackjack —Å –∫—É—Ä–∏—Ü–µ–π</title>
<style>
/* === –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å === */
html, body {
  margin: 0;
  padding: 0;
  font-family: 'Arial', sans-serif;
  background: linear-gradient(-45deg, #1c1c1c, #2c2c2c, #1a1a1a, #3a3a3a);
  background-size: 400% 400%;
  animation: bgAnim 10s ease infinite;
  color: #fff;
  overflow-x: hidden;
}
@keyframes bgAnim {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
h1 {
  text-align: center;
  font-size: 2.5rem;
  margin: 20px 0;
  text-shadow: 0 0 15px #ffcc00;
}
#balance {
  text-align: center;
  font-size: 1.4rem;
  margin-bottom: 10px;
}
/* === –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ === */
#loading-screen {
  position: fixed;
  top:0; left:0;
  width:100%; height:100%;
  background:#111;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  z-index:999;
  color:#fff;
  font-size:1.5rem;
  transition: opacity 1s;
}
#loading-screen img {
  width:120px;
  animation: chickenDance 1s infinite;
}
@keyframes chickenDance {
  0%,100%{ transform: translateY(0) rotate(-5deg);}
  50%{ transform: translateY(-10px) rotate(5deg);}
}
/* === –ò–≥—Ä–æ–≤–∞—è –∞—Ä–µ–Ω–∞ === */
.arena {
  max-width: 700px;
  margin: 0 auto;
  background: rgba(0,0,0,0.5);
  border-radius: 15px;
  padding: 20px;
  box-shadow: 0 0 20px rgba(255,255,255,0.2);
  position: relative;
  overflow: hidden;
}
/* –ó—Ä–∏—Ç–µ–ª–∏ */
.spectators {
  position: absolute;
  top: -20px;
  width: 100%;
  display: flex;
  justify-content: space-around;
}
.spectator {
  width: 15px; height: 20px;
  background: #444;
  border-radius: 50% 50% 0 0;
  animation: spectatorsAnim 2s infinite alternate;
}
@keyframes spectatorsAnim {
  from { transform: translateY(0); }
  to { transform: translateY(-5px); }
}
/* –ö—É—Ä–∏—Ü–∞-–∫—Ä—É–ø—å–µ */
.dealer {
  text-align:center;
  margin-bottom:20px;
}
.dealer img {
  width:120px;
  transition: transform 0.5s;
}
.dealer.win img { transform: scale(1.2) rotate(-5deg); }
.dealer.lose img { transform: scale(0.9) rotate(5deg) translateY(10px); opacity:0.8; }
/* –ö–∞—Ä—Ç—ã */
.cards {
  display:flex;
  justify-content:center;
  gap:5px;
  margin-top:10px;
  flex-wrap:wrap;
}
.card {
  width:55px; height:75px;
  background:#fff;
  color:#000;
  border-radius:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
  font-size:1.2rem;
  box-shadow:0 3px 8px rgba(0,0,0,0.5);
  opacity:0;
  transform:translateY(-30px);
  animation: dealCard 0.4s forwards;
}
@keyframes dealCard {
  to { opacity:1; transform:translateY(0); }
}
/* –ö–Ω–æ–ø–∫–∏ –∏ —Å—Ç–∞–≤–∫–∏ */
.controls, .bet-controls {
  display:flex;
  justify-content:center;
  gap:10px;
  margin-top:15px;
  flex-wrap:wrap;
}
button {
  background:#ffcc00;
  color:#000;
  font-weight:bold;
  padding:10px 20px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-size:1rem;
  transition: background 0.3s, transform 0.2s;
}
button:hover { background:#ffe166; transform: scale(1.05);}
input[type=number] {
  width:100px;
  padding:5px;
  text-align:center;
  font-size:1rem;
}
/* –°–æ–æ–±—â–µ–Ω–∏–µ */
#message {
  margin-top:15px;
  font-size:1.3rem;
  text-align:center;
  min-height:1.5em;
  text-shadow:0 0 8px #ffcc00;
}
/* –ò—Å—Ç–æ—Ä–∏—è */
.history {
  width:100%;
  max-width:700px;
  margin:20px auto;
  background:rgba(0,0,0,0.3);
  border-radius:10px;
  padding:10px;
}
.history table {
  width:100%;
  border-collapse:collapse;
  font-size:0.9rem;
}
.history th, .history td {
  border-bottom:1px solid #555;
  padding:5px;
  text-align:center;
}
.win-row { color:#00ff90; }
.lose-row { color:#ff4b4b; }
.draw-row { color:#ffcc00; }
/* –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ */
.confetti {
  position: fixed;
  width: 10px;
  height: 10px;
  background: red;
  top: -10px;
  animation: fall linear forwards;
}
@keyframes fall {
  to { transform: translateY(100vh) rotate(360deg); opacity:0; }
}
/* –ê–¥–∞–ø—Ç–∏–≤ */
@media(max-width:600px){
  .card { width:40px; height:60px; font-size:1rem;}
  .dealer img { width:90px; }
}
</style>
</head>
<body>
<!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
<div id="loading-screen">
  <img src="https://cdn-icons-png.flaticon.com/512/1998/1998611.png" alt="–ö—É—Ä–∏—Ü–∞">
  <div>–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–∑–∏–Ω–æ...</div>
</div>

<h1>Blackjack —Å –∫—É—Ä–∏—Ü–µ–π</h1>
<div id="balance"></div>
<div class="bet-controls">
  <label>–°—Ç–∞–≤–∫–∞: </label>
  <input type="number" id="bet" min="100" step="100">
  <button onclick="startGame()">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
  <button onclick="toggleMusic()">üéµ</button>
</div>

<div class="arena">
  <div class="spectators">
    <div class="spectator"></div><div class="spectator"></div><div class="spectator"></div>
    <div class="spectator"></div><div class="spectator"></div><div class="spectator"></div>
  </div>

  <div id="dealer" class="dealer">
    <img src="https://cdn-icons-png.flaticon.com/512/1998/1998611.png" alt="–ö—É—Ä–∏—Ü–∞-–∫—Ä—É–ø—å–µ">
    <div>–ö–∞—Ä—Ç—ã –∫—Ä—É–ø—å–µ:</div>
    <div class="cards" id="dealer-cards"></div>
    <div>–û—á–∫–∏: <span id="dealer-score">0</span></div>
  </div>

  <div id="player" class="player" style="text-align:center;">
    <div>–¢–≤–æ–∏ –∫–∞—Ä—Ç—ã:</div>
    <div class="cards" id="player-cards"></div>
    <div>–û—á–∫–∏: <span id="player-score">0</span></div>
  </div>

  <div id="controls" class="controls" style="display:none;">
    <button onclick="hit()">–í–∑—è—Ç—å –∫–∞—Ä—Ç—É</button>
    <button onclick="stand()">–•–≤–∞—Ç–∏—Ç</button>
  </div>

  <div id="message"></div>
</div>

<div class="history">
  <table>
    <thead>
      <tr><th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th><th>–°—Ç–∞–≤–∫–∞</th><th>–ë–∞–ª–∞–Ω—Å</th></tr>
    </thead>
    <tbody id="history-body"></tbody>
  </table>
</div>

<!-- –ó–≤—É–∫–∏ -->
<audio id="bg-music" loop>
  <source src="https://cdn.pixabay.com/download/audio/2023/07/31/audio_4f5f76e197.mp3?filename=casino-loop-14794.mp3" type="audio/mpeg">
</audio>
<audio id="sound-deal" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_9b2a0fd1b0.mp3?filename=chicken-cluck-2-6867.mp3"></audio>
<audio id="sound-win" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_7b75ec2d5e.mp3?filename=chicken-cluck-6866.mp3"></audio>
<audio id="sound-lose" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_3cbd932a7f.mp3?filename=chicken-cry-6869.mp3"></audio>

<script>
/* === –õ–æ–≥–∏–∫–∞ –∏–≥—Ä—ã === */
let balance = parseInt(localStorage.getItem('balance')) || 50000;
let historyData = JSON.parse(localStorage.getItem('history')) || [];
let bet = 1000;
let deck = [];
let playerCards = [];
let dealerCards = [];
let gameOver = false;

document.getElementById('bet').value = bet;
updateBalance();
renderHistory();

/* –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ª–æ–¥—ã */
function createDeck() {
  const suits = ['‚ô†', '‚ô•', '‚ô¶', '‚ô£'];
  const values = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
  deck = [];
  for (let s of suits) {
    for (let v of values) {
      deck.push({value:v,suit:s});
    }
  }
}

/* –í–∑—è—Ç—å –∫–∞—Ä—Ç—É */
function drawCard() {
  const idx = Math.floor(Math.random()*deck.length);
  return deck.splice(idx,1)[0];
}

/* –°—á—ë—Ç */
function calculateScore(cards) {
  let score=0, aces=0;
  for (let c of cards){
    if(['J','Q','K'].includes(c.value)) score+=10;
    else if(c.value==='A'){ score+=11; aces++; }
    else score+=parseInt(c.value);
  }
  while(score>21 && aces>0){ score-=10; aces--; }
  return score;
}

/* –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–∞—Ä—Ç */
function renderCards() {
  document.getElementById('player-cards').innerHTML = playerCards.map(c=>`<div class="card">${c.value}${c.suit}</div>`).join('');
  document.getElementById('dealer-cards').innerHTML = dealerCards.map(c=>`<div class="card">${c.value}${c.suit}</div>`).join('');
  document.getElementById('player-score').textContent = calculateScore(playerCards);
  document.getElementById('dealer-score').textContent = calculateScore(dealerCards);
}

/* –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã */
function startGame(){
  bet = parseInt(document.getElementById('bet').value);
  if(bet>balance || bet<=0){ alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –∏–ª–∏ —Å—Ç–∞–≤–∫–∞ –Ω–µ–≤–µ—Ä–Ω–∞'); return; }
  createDeck();
  playerCards=[drawCard(), drawCard()];
  dealerCards=[drawCard(), drawCard()];
  gameOver=false;
  document.getElementById('message').textContent='';
  document.getElementById('controls').style.display='flex';
  document.getElementById('dealer').className='dealer';
  playSound('deal');
  renderCards();
}

/* –í–∑—è—Ç—å –∫–∞—Ä—Ç—É */
function hit(){
  if(gameOver) return;
  playerCards.push(drawCard());
  playSound('deal');
  renderCards();
  if(calculateScore(playerCards)>21){
    balance-=bet;
    endGame('–ü–µ—Ä–µ–±–æ—Ä! –¢—ã –ø—Ä–æ–∏–≥—Ä–∞–ª.', 'lose');
  }
}

/* –•–≤–∞—Ç–∏—Ç */
function stand(){
  if(gameOver) return;
  while(calculateScore(dealerCards)<17){
    dealerCards.push(drawCard());
  }
  const ps=calculateScore(playerCards);
  const ds=calculateScore(dealerCards);
  if(ds>21 || ps>ds){
    balance+=bet;
    endGame('–¢—ã –≤—ã–∏–≥—Ä–∞–ª!', 'win');
  } else if(ps<ds){
    balance-=bet;
    endGame('–ö—É—Ä–∏—Ü–∞ –ø–æ–±–µ–¥–∏–ª–∞!', 'lose');
  } else {
    endGame('–ù–∏—á—å—è!', 'draw');
  }
}

/* –ö–æ–Ω–µ—Ü –∏–≥—Ä—ã */
function endGame(message, result){
  document.getElementById('message').textContent = message;
  document.getElementById('controls').style.display='none';
  document.getElementById('dealer').classList.add(result==='win'?'lose':result==='lose'?'win':'');
  playSound(result);
  if(result==='win') createConfetti();
  updateBalance();
  addHistory(result, bet, balance);
  gameOver=true;
}

/* –ë–∞–ª–∞–Ω—Å */
function updateBalance(){
  document.getElementById('balance').textContent = `–ë–∞–ª–∞–Ω—Å: ${balance.toLocaleString()} MDL`;
  localStorage.setItem('balance', balance);
}

/* –ó–≤—É–∫–∏ */
function playSound(type){
  const sounds = {
    deal:'sound-deal',
    win:'sound-win',
    lose:'sound-lose'
  };
  const el=document.getElementById(sounds[type]);
  if(el){ el.currentTime=0; el.play(); }
}

/* –ò—Å—Ç–æ—Ä–∏—è */
function addHistory(result, bet, bal){
  historyData.unshift({result, bet, balance: bal});
  if(historyData.length>10) historyData.pop();
  localStorage.setItem('history', JSON.stringify(historyData));
  renderHistory();
}
function renderHistory(){
  const tbody=document.getElementById('history-body');
  tbody.innerHTML='';
  historyData.forEach(h=>{
    const tr=document.createElement('tr');
    tr.className = h.result==='win'?'win-row':h.result==='lose'?'lose-row':'draw-row';
    tr.innerHTML=`<td>${h.result==='win'?'–ü–æ–±–µ–¥–∞':h.result==='lose'?'–ü—Ä–æ–∏–≥—Ä—ã—à':'–ù–∏—á—å—è'}</td>
                  <td>${h.bet.toLocaleString()} MDL</td>
                  <td>${h.balance.toLocaleString()} MDL</td>`;
    tbody.appendChild(tr);
  });
}

/* –ú—É–∑—ã–∫–∞ */
function toggleMusic(){
  const music=document.getElementById('bg-music');
  if(music.paused){ music.play(); } else { music.pause(); }
}

/* –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ */
function createConfetti(){
  for(let i=0;i<50;i++){
    const conf=document.createElement('div');
    conf.className='confetti';
    conf.style.left=Math.random()*100+'vw';
    conf.style.backgroundColor=`hsl(${Math.random()*360},100%,50%)`;
    conf.style.animationDuration=(Math.random()*3+2)+'s';
    conf.style.transform=`rotate(${Math.random()*360}deg)`;
    document.body.appendChild(conf);
    setTimeout(()=>conf.remove(),5000);
  }
}

/* –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ */
window.onload = ()=>{
  setTimeout(()=>{
    document.getElementById('loading-screen').style.opacity='0';
    setTimeout(()=>document.getElementById('loading-screen').remove(),1000);
  },2000);
}
</script>
</body>
</html>
